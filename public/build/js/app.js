const servicio={id:"",nombre:"",motivo:"",especie:"",sexo:"",peso_kg:"","nombreDueño":"",numeroContacto:"",domicilio:"",fecha:"",cliente:"",rfc:"",observaciones:""};let ultimaSeleccionCliente="";function iniciarApp(){agregarEventosModal(),mostrarSeccionPorDefecto(),nombre(),fecha(),motivo(),peso_kg(),sexo(),especie(),nombreDueño(),numeroContacto(),domicilio(),cliente(),rfc(),inspector(),observaciones(),imprimiendo()}function agregarEventosModal(){const e=document.getElementById("abrirModal"),o=document.getElementById("cerrarModal");e.addEventListener("click",showModal),o.addEventListener("click",hideModal)}function showModal(){document.getElementById("miModal").style.display="block"}function hideModal(){document.getElementById("miModal").style.display="none",window.location.href="/def"}function mostrarSeccionPorDefecto(){const e=document.querySelectorAll(".seccion-fallecido, .seccion-familia, .seccion-autorizacion, .seccion-evidencia, .seccion-certificado, .seccion-video, .seccion-remisiones, .seccion-comprobante, .seccion-observaciones");e.forEach(e=>{e.style.display="none"});const o=document.querySelectorAll(".navModal a"),n=document.querySelector(".seccion-fallecido");o.forEach(t=>{"fallecido"===t.getAttribute("data-tab")&&(t.classList.add("active"),n.style.display="block"),t.addEventListener("click",(function(n){n.preventDefault(),o.forEach(e=>{e.classList.remove("active")}),t.classList.add("active");const c=t.getAttribute("data-tab");e.forEach(e=>{e.classList.contains("seccion-"+c)?e.style.display="block":e.style.display="none"})}))})}function nombre(){const e=document.querySelector("#nombre");e.addEventListener("input",(function(){servicio.nombre=e.value}))}function fecha(){const e=document.querySelector("#fecha");e.addEventListener("input",(function(){servicio.fecha=e.value}))}function motivo(){const e=document.querySelector("#motivo");e.addEventListener("input",(function(){servicio.motivo=e.value}))}function peso_kg(){const e=document.querySelector("#peso_kg");e.addEventListener("input",(function(){servicio.peso_kg=e.value}))}function sexo(){const e=document.querySelector("#sexo");e.addEventListener("change",(function(){servicio.sexo=e.value}))}function especie(){const e=document.querySelector("#especie");e.addEventListener("input",(function(){servicio.especie=e.value}))}function nombreDueño(){const e=document.querySelector("#nombreDueño");e.addEventListener("input",(function(){servicio.nombreDueño=e.value}))}function numeroContacto(){const e=document.querySelector("#numeroContacto");e.addEventListener("input",(function(){servicio.numeroContacto=e.value}))}function cliente(){const e=document.querySelector("#cliente"),o=document.getElementById("suggestions");let n=!1;e.addEventListener("input",(async function(){const n=e.value;if(n.length>=2)try{const t="/autocomplete?term="+n,c=await fetch(t),i=await c.json();o.innerHTML="",i.forEach(n=>{if(""!==n.nombre.trim()){const t=document.createElement("div");t.textContent=n.nombre,t.addEventListener("mousedown",(function(){const t=n.nombre.trim();e.value=t,servicio.cliente=t,o.style.display="none"})),o.appendChild(t)}}),o.style.display=i.length>0?"block":"none"}catch(e){console.error("Error al obtener sugerencias de clientes:",e)}else o.style.display="none"})),e.addEventListener("mousedown",(async function(){try{const n="/autocomplete?term=",t=await fetch(n),c=await t.json();o.innerHTML="",c.forEach(n=>{if(""!==n.nombre.trim()){const t=document.createElement("div");t.textContent=n.nombre,t.addEventListener("mousedown",(function(){const t=n.nombre.trim();e.value=t,servicio.cliente=t,o.style.display="none"})),o.appendChild(t)}}),o.style.display=c.length>0?"block":"none"}catch(e){console.error("Error al obtener sugerencias de clientes:",e)}})),o.addEventListener("mouseenter",(function(){n=!0})),o.addEventListener("mouseleave",(function(){n=!1})),e.addEventListener("input",(function(){servicio.cliente=e.value})),e.addEventListener("blur",(function(){n||(o.style.display="none")}))}function domicilio(){const e=document.querySelector("#domicilio");e.addEventListener("input",(function(){servicio.domicilio=e.value}))}function observaciones(){const e=document.querySelector("#observaciones");e.addEventListener("input",(function(){servicio.observaciones=e.value}))}function rfc(){const e=document.querySelector("#rfc");e.addEventListener("input",(function(){servicio.rfc=e.value}))}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()})),document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".open-modal");"true"===new URLSearchParams(window.location.search).get("modal")&&showModal()}));const botonReservar=document.getElementById("botonReservar");async function reservarServicio(){const e=new FormData,{nombre:o,motivo:n,especie:t,sexo:c,peso_kg:i,"nombreDueño":r,numeroContacto:a,domicilio:s,fecha:d,cliente:l,rfc:u,observaciones:m}=servicio,v=l.trim(),f=o.trim(),p=n.trim();e.append("nombre",f),e.append("motivo",p),e.append("especie",t),e.append("sexo",c),e.append("peso_kg",i),e.append("nombreDueño",r),e.append("numeroContacto",a),e.append("domicilio",s),e.append("fecha",d),e.append("cliente",v),e.append("rfc",u),e.append("observaciones",m);const y=document.getElementById("archivo").files[0];e.append("archivo",y);const E=document.getElementById("archivo2").files[0];e.append("archivo2",E);const b=document.getElementById("archivo3").files[0];e.append("archivo3",b);const h=document.getElementById("archivo4").files[0];e.append("archivo4",h);const g=document.getElementById("archivo5").files[0];e.append("archivo5",g);const L=document.getElementById("archivo7").files[0];e.append("archivo7",L),console.log([...e]);try{const o="/api/servicios",n=await fetch(o,{method:"POST",body:e}),t=await n.json();console.log(t),t.resultado&&Swal.fire({icon:"success",title:"Servicio creado",text:"Tu servicio fue creado con éxito"}).then(()=>{window.location.reload()})}catch(e){Swal.fire({icon:"error",title:"Error",text:"Hubo un error al guardar el servicio"})}}botonReservar.addEventListener("click",(function(e){e.preventDefault(),reservarServicio()}));const filasSeleccionables=document.querySelectorAll(".seleccionable");function imprimiendo(){document.querySelector("#imprimir").addEventListener("click",(function(){window.print()}))}function inspector(){const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.remove("lazy-load")})});document.querySelectorAll(".lazy-load").forEach(o=>{e.observe(o)})}filasSeleccionables.forEach(e=>{e.addEventListener("click",()=>{filasSeleccionables.forEach(e=>{e.classList.remove("seleccionada")}),e.classList.add("seleccionada")})});